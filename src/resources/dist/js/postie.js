void 0===Craft.Postie&&(Craft.Postie={}),$((function(){$(document).on("change",".provider-shipping-methods-all-switch .lightswitch",(function(){var t=$(".provider-shipping-methods").find(".lightswitch");$(this).hasClass("on")?t.each((function(){$(this).data("lightswitch").turnOn()})):t.each((function(){$(this).data("lightswitch").turnOff()}))}))})),Craft.Postie.ProviderConnection=Garnish.Base.extend({init(t){this.providerHandle=t,this.$container=$("#settings-providers-"+this.providerHandle+"-js-postie-connection"),this.$status=this.$container.find(".js-status"),this.$statusText=this.$container.find(".js-status-text"),this.$refreshBtn=this.$container.find(".js-btn-refresh"),this.addListener(this.$refreshBtn,"click","onRefresh")},onRefresh(t){t.preventDefault();var s={};if(this.$form=$("#tab-"+this.providerHandle),this.$form){var i=Garnish.getPostData(this.$form),e=Craft.expandPostArray(i);e&&e.settings&&e.settings.providers&&e.settings.providers[this.providerHandle]&&(s=e.settings.providers[this.providerHandle])}var n={providerHandle:this.providerHandle,settings:s};this.$refreshBtn.addClass("vui-loading vui-loading-tiny"),this.$statusText.html(Craft.t("postie","Connecting...")),this.$status.removeClass("on off");var o="postie-"+this.providerHandle+"-connect";document.cookie=o+"=;",Craft.sendActionRequest("POST","postie/providers/check-connection",{data:n}).then((t=>{this.$statusText.html(Craft.t("postie","Connected")),this.$status.addClass("on"),document.cookie=o+"=true;"})).catch((({response:t})=>{var s=Craft.t("postie","An error occurred.")+"<br><br><code>"+t.data.message+"</code>";this.$statusText.html(Craft.t("postie","Error")),this.$status.addClass("off"),new Craft.Postie.ProviderConnectionModal(s)})).finally((()=>{this.$refreshBtn.removeClass("vui-loading vui-loading-tiny")}))}}),Craft.Postie.ProviderConnectionModal=Garnish.Modal.extend({init(t){this.$form=$('<form class="modal vui-connection-error-modal" method="post" accept-charset="UTF-8"/>').appendTo(Garnish.$bod),this.$body=$('<div class="body"></div>').appendTo(this.$form),this.$cancelBtn=$('<div class="vui-dialog-close"></div>').appendTo(this.$body),this.$pane=$('<div class="vui-error-pane error"></div>').appendTo(this.$body),this.$content=$('<div class="vui-error-content"></div>').appendTo(this.$pane),this.$alert=$('<span data-icon="alert"></span>').appendTo(this.$content),this.$errorMsg=$('<span class="error">'+t+"</span>").appendTo(this.$content),this.addListener(this.$cancelBtn,"click","onFadeOut"),this.base(this.$form)},onFadeOut(){this.$form.remove(),this.$shade.remove()}});
//# sourceMappingURL=postie.js.map